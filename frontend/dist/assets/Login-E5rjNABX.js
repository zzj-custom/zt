import{L as S}from"./Logo-BnkNIPeP.js";import{c as j,d as z}from"./App-C6ci30go.js";import{c as i,r as h,m as A,u as U}from"./index-DHMX01H1.js";import{m as b,s as Z,af as F,x as p,v,o as x,e as R,w as a,b as e,al as _,d,a5 as V,B as c,Z as m,W as T,am as D,V as E,Y as w,I as G,c as P,G as W,X,a as y,R as Y}from"./index-D7yCSS-M.js";const H=b({__name:"LoginForm",setup($){const f=Z(),t=F({}),I=o=>/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(o),B=o=>/^\d{6}$/.test(o.toString()),C=p({email:{required:i.withMessage("邮箱必须填写",h),emailIdentify:i.withMessage("请填写正确的邮箱地址",I)},captcha:{required:i.withMessage("验证码必须填写",h),captchaIdentify:i.withMessage("请填写正确的验证码",B),minLength:i.withMessage("验证码长度必须为6位",A(6))}}),L=p(""),u=p(!1),g=v(()=>Math.min(100,L.value.length*10)),M=v(()=>{const o=Math.floor(g.value/40);return["error","warning","success"][o]}),k=async()=>{if(u.value=!0,t.email==="")return;const o=await j(t.email);console.log("response:",o),o.code===0&&(u.value=!1)},r=U(C,t),q=async()=>{if(await r.value.$validate(),!r.value.$invalid){console.log("验证成功"),await N();return}console.error("验证错误：",r.value.$errors)},N=async()=>{const o={email:t.email,captcha:Number(t.captcha)},{code:s,msg:l,result:n}=await z(o);console.log("code:",s,"result",n,"msg",l),s===0&&(f.login({Id:n.Id,name:n.Name,email:n.email,avatar:n.avatar??"@/assets/images/users/avatar-1.jpg",mobile:n.mobile}),await G.push("/"))};return(o,s)=>(x(),R(w,{class:"d-flex mb-3",modelValue:t,"onUpdate:modelValue":s[2]||(s[2]=l=>t=l)},{default:a(()=>[e(m,{cols:"12"},{default:a(()=>[e(_,{class:"font-weight-bold mb-1"},{default:a(()=>[d("账号")]),_:1}),e(V,{modelValue:t.email,"onUpdate:modelValue":s[0]||(s[0]=l=>t.email=l),color:"primary",density:"compact",placeholder:"请填写邮箱地址","prepend-inner-icon":"mdi-email-outline",variant:"outlined","error-messages":c(r).email.$errors.map(l=>String(l.$message)),onBlur:c(r).email.$touch,onInput:c(r).email.$touch,required:"",clearable:""},null,8,["modelValue","error-messages","onBlur","onInput"])]),_:1}),e(m,{cols:"12"},{default:a(()=>[e(_,{class:"font-weight-bold mb-1"},{default:a(()=>[d("验证码")]),_:1}),e(V,{modelValue:t.captcha,"onUpdate:modelValue":s[1]||(s[1]=l=>t.captcha=l),color:"primary",density:"compact",placeholder:"验证码","prepend-inner-icon":"mdi-lock-outline",variant:"outlined","error-messages":c(r).captcha.$errors.map(l=>String(l.$message)),onBlur:c(r).captcha.$touch,onInput:c(r).captcha.$touch,disabled:u.value,required:""},{append:a(()=>[e(T,{onClick:k,style:{color:"#D50000"}},{default:a(()=>[d("mdi-near-me")]),_:1})]),loader:a(()=>[e(D,{active:u.value,color:M.value,"model-value":g.value,height:"4",indeterminate:""},null,8,["active","color","model-value"])]),_:1},8,["modelValue","error-messages","onBlur","onInput","disabled"])]),_:1}),e(m,{cols:"12",class:"pt-0"},{default:a(()=>[e(E,{onClick:q,color:"primary",size:"large",block:"",type:"submit"},{default:a(()=>[d("登录")]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),J={class:"authentication"},K={class:"d-flex justify-center py-4"},O=y("div",{class:"text-body-1 text-muted text-center mb-3"},"你的小工具库",-1),se=b({__name:"Login",setup($){return(f,t)=>(x(),P("div",J,[e(Y,{fluid:"",class:"pa-3"},{default:a(()=>[e(w,{class:"h-100vh d-flex justify-center align-center"},{default:a(()=>[e(m,{cols:"12",lg:"4",xl:"3",class:"d-flex align-center"},{default:a(()=>[e(W,{rounded:"md",elevation:"12",class:"px-sm-1 px-0 withbg mx-auto","max-width":"400"},{default:a(()=>[e(X,{class:"pa-sm-8"},{default:a(()=>[y("div",K,[e(S)]),O,e(H)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]))}});export{se as default};
